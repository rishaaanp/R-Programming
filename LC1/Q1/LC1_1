# Step 1: Read a paragraph of text
cat("Enter a paragraph of text:\n")
paragraph <- readline()

# Step 2: Remove punctuation for analysis
clean_paragraph <- gsub("[[:punct:]]", "", paragraph)

# Step 3: Split the paragraph into words
words <- unlist(strsplit(clean_paragraph, "\\s+"))

# Step 4: Count the total number of words
total_words <- length(words)
cat("Total number of words:", total_words, "\n")

# Step 5: Calculate the average word length
word_lengths <- nchar(words)
avg_word_length <- mean(word_lengths)
cat("Average word length:", round(avg_word_length, 2), "\n")

# Step 6: Identify and print the longest word
longest_word <- words[which.max(word_lengths)]
cat("Longest word:", longest_word, "\n")

# Step 7: Replace all occurrences of a specific word (case-insensitive)
cat("Enter the word to replace:\n")
old_word <- readline()
cat("Enter the new word:\n")
new_word <- readline()

# Case-insensitive replacement using regex
pattern <- paste0("(?i)\\b", old_word, "\\b")  # match whole word, ignore case
paragraph_updated <- gsub(pattern, new_word, paragraph, perl = TRUE)

cat("Updated paragraph:\n", paragraph_updated, "\n")
